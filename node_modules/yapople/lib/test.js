const { Client } = require('./yapople');

const tlsOptions = {
    hostname: 'pop.mail.ru',
    port:  995,
    tls: true,
    username: 'yapople@bk.ru',
    password: 'elpopayelpopayelpopayelpopay',
};

const client = new Client({
    ...tlsOptions,
    mailparser: true,
});

const check = async () => {
    // await client.connect();
    // const [, ...messages] = await client.retrieveAndDeleteAll();
    // await client.quit();
    // if (messages.length) {
    //     console.log(messages);  // <-- Expected new messages
    // } else {
    //     await (new Promise(resolve => setTimeout(resolve, 1000)));
    //     await check();
    // }
    await client.connect();
    const list = await client.top(0, 10);
    console.log(list);
    await client.quit();
};

check().catch(err => console.error(err));

